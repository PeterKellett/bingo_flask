<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <title>Bingo</title>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup"
                aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                    {% if page_title == 'Page 1' %}
                        <a class="nav-link active" aria-current="page" href="{{ url_for('index') }}">Page 1</a>
                        <a class="nav-link" href="{{ url_for('page_2') }}">Page 2</a>
                    {% elif page_title == 'Page 2' %}
                        <a class="nav-link" aria-current="page" href="{{ url_for('index') }}">Page 1</a>
                        <a class="nav-link active" href="{{ url_for('page_2') }}">Page 2</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </nav>
    <div class="container">
        {% with messages = get_flashed_messages() %} 
            {% if messages %}
                <ul class="flashes">
                    {% for message in messages %}
                    <li>{{ message }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}
    </div>
    <div class="container">
        <div class="row">
            <div class="col">
                <div id="div1"></div>
            </div>
        </div>
    </div>
    {% block content %}
    {% endblock %}

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
        crossorigin="anonymous"></script>
    <script>
        $(document).ready(function(){
            console.log("Document ready");
            $(".flashes").fadeOut("slow");
            // screen size script
            var txt = "";
            txt += "Width: " + $("body").outerWidth() + "</br>";
            txt += "Height: " + $("body").outerHeight();
            $("#div1").html(txt);

            $('.badge').click(function(){
                console.log("done" + $(this).attr('done'));
                var done = $(this).attr('done')
                if (done == 'true') {
                    console.log("if")
                    $(this).attr('done', 'false').addClass('bg-success');
                }
                else {
                    console.log("else")
                    $(this).attr('done', 'true').removeClass('bg-success');
                    $('.col').removeClass('yellow-background');
                }            
            });


            var numbers_clicked = []; 
            var score = 0;  
            $('#score').html(score); 
            horizontal_done = $('.horizontal').attr('done');
            vertical_done = $('.vertical').attr('done');
            right_diagonal_done = $('.right_diagonal').attr('done');
            left_diagonal_done = $('.left_diagonal').attr('done');
            four_corners_done = $('.four_corners').attr('done');
            cross_done = $('.cross').attr('done');
            bingo_done = $('.bingo').attr('done');       
            $('img').click(function() {
                row_0 = [];
                row_1 = [];
                row_2 = [];
                row_3 = [];
                col_0 = [];
                col_1 = [];
                col_2 = [];
                col_3 = [];
                right_diagonal = [];
                left_diagonal = [];
                four_corners = [];
                cross = [];
                var clicked = $(this).attr("clicked");
                var image_clicked = $(this).attr("id");
                id = image_clicked.split("_");
                //console.log(id); 
                x = parseInt(id[0]);
                y = parseInt(id[1]);
                id = [x, y];
                //console.log("id=" + id); 
                //console.log("y=" + y); 

                if (clicked == 'true') {
                    $(this).attr('clicked', 'false').addClass('red-border').fadeTo(250, 1.0);
                    for (i = 0; i < numbers_clicked.length; i++) {
                        //console.log(numbers_clicked[i]);
                        if (numbers_clicked[i][0] == x && numbers_clicked[i][1] == y) {
                            numbers_clicked.splice([i], 1);
                            $('.col').removeClass('yellow-background');
                        }
                    }                   
                }
                else {
                    $(this).attr('clicked', 'true').removeClass('red-border').fadeTo(1000, 0.4);
                    numbers_clicked.push(id);
                    //console.log(numbers_clicked);
                }

                numbers_clicked.forEach(check_card);
                
                function check_card(value, index, array) {
                    //Row 0                   
                    if (value[1] == 0) {
                        row_0.push(1);
                        if (value[0] == 0) {
                            left_diagonal.push(1);
                            four_corners.push(1);
                            cross.push(1);
                        }
                        if (value[0] == 3) {
                            right_diagonal.push(1);
                            four_corners.push(1);
                            cross.push(1);
                        }
                    }
                    //Row 1                   
                    if (value[1] == 1) {
                        row_1.push(1);
                        if (value[0] == 1) {
                            left_diagonal.push(1);
                            cross.push(1);
                        }
                        if (value[0] == 2) {
                            right_diagonal.push(1);
                            cross.push(1);
                        }
                    }
                    //Row 2                   
                    if (value[1] == 2) {
                        row_2.push(1);
                        if (value[0] == 2) {
                            left_diagonal.push(1);
                            cross.push(1);
                        }
                        if (value[0] == 1) {
                            right_diagonal.push(1);
                            cross.push(1);
                        }
                    }
                    //Row 3                  
                    if (value[1] == 3) {
                        row_3.push(1);
                        if (value[0] == 3) {
                            left_diagonal.push(1);
                            four_corners.push(1);
                            cross.push(1);
                        }
                        if (value[0] == 0) {
                            right_diagonal.push(1);
                            four_corners.push(1);
                            cross.push(1);
                        }
                    }
                    
                    //Column 0                   
                    if (value[0] == 0) {
                        col_0.push(1);
                    }
                    //Column 1                  
                    if (value[0] == 1) {
                        col_1.push(1);
                    }    
                    //Column 2                  
                    if (value[0] == 2) {
                        col_2.push(1);
                    }                                
                    //Column 3                  
                    if (value[0] == 3) {
                        col_3.push(1);
                    } 
                    
                    //Check for full sets
                    if (horizontal_done != 'true') {
                        if (row_0.length == 4) {
                            $('.row_0_col_0').addClass('yellow-background');
                            $('.row_0_col_1').addClass('yellow-background');
                            $('.row_0_col_2').addClass('yellow-background');
                            $('.row_0_col_3').addClass('yellow-background');
                            $('#horizontal').show();
                            score += 1;
                            $('#score').html(score);
                            horizontal_done = 'true';
                        }                        
                        if (row_1.length == 4) {
                            $('.row_1_col_0').addClass('yellow-background');
                            $('.row_1_col_1').addClass('yellow-background');
                            $('.row_1_col_2').addClass('yellow-background');
                            $('.row_1_col_3').addClass('yellow-background');
                            $('#horizontal').show();
                            score += 1;
                            $('#score').html(score);
                            horizontal_done = 'true';
                        }                        
                        if (row_2.length == 4) {
                            $('.row_2_col_0').addClass('yellow-background');
                            $('.row_2_col_1').addClass('yellow-background');
                            $('.row_2_col_2').addClass('yellow-background');
                            $('.row_2_col_3').addClass('yellow-background');
                            $('#horizontal').show();
                            score += 1;
                            $('#score').html(score);
                            horizontal_done = 'true';
                        }
                        if (row_3.length == 4) {
                            $('.row_3_col_0').addClass('yellow-background');
                            $('.row_3_col_1').addClass('yellow-background');
                            $('.row_3_col_2').addClass('yellow-background');
                            $('.row_3_col_3').addClass('yellow-background');
                            $('#horizontal').show();
                            score += 1;
                            $('#score').html(score);
                            horizontal_done = 'true';
                        }
                    }
                        
                    if (vertical_done != 'true') {
                        if (col_0.length == 4) {
                            $('.row_0_col_0').addClass('yellow-background');
                            $('.row_1_col_0').addClass('yellow-background');
                            $('.row_2_col_0').addClass('yellow-background');
                            $('.row_3_col_0').addClass('yellow-background');
                            $('#vertical').show();
                            score += 1;
                            $('#score').html(score);
                            vertical_done = 'true';
                        }                    
                        if (col_1.length == 4) {
                            $('.row_0_col_1').addClass('yellow-background');
                            $('.row_1_col_1').addClass('yellow-background');
                            $('.row_2_col_1').addClass('yellow-background');
                            $('.row_3_col_1').addClass('yellow-background');
                            $('#vertical').show();
                            score += 1;
                            $('#score').html(score);
                            vertical_done = 'true';
                        }
                        if (col_2.length == 4) {
                            $('.row_0_col_2').addClass('yellow-background');
                            $('.row_1_col_2').addClass('yellow-background');
                            $('.row_2_col_2').addClass('yellow-background');
                            $('.row_3_col_2').addClass('yellow-background');
                            $('#vertical').show();
                            score += 1;
                            $('#score').html(score);
                            vertical_done = 'true';
                        }
                        if (col_3.length == 4) {
                            $('.row_0_col_3').addClass('yellow-background');
                            $('.row_1_col_3').addClass('yellow-background');
                            $('.row_2_col_3').addClass('yellow-background');
                            $('.row_3_col_3').addClass('yellow-background');
                            $('#vertical').show();
                            score += 1;
                            $('#score').html(score);
                            vertical_done = 'true';
                        }
                    }
                                       
                    if (left_diagonal_done != 'true') {
                        if (left_diagonal.length == 4) {
                            $('.row_0_col_0').addClass('yellow-background');
                            $('.row_1_col_1').addClass('yellow-background');
                            $('.row_2_col_2').addClass('yellow-background');
                            $('.row_3_col_3').addClass('yellow-background');
                            $('#left_diagonal').show();
                            score += 3;
                            $('#score').html(score);
                            left_diagonal_done = 'true';
                        }   
                    }
                    
                    if (right_diagonal_done != 'true') {
                        if (right_diagonal.length == 4) {
                            $('.row_0_col_3').addClass('yellow-background');
                            $('.row_1_col_2').addClass('yellow-background');
                            $('.row_2_col_1').addClass('yellow-background');
                            $('.row_3_col_0').addClass('yellow-background');
                            $('#right_diagonal').show();
                            score += 3;
                            $('#score').html(score);
                            right_diagonal_done = 'true';
                        }
                    }
                    
                    if (four_corners_done != 'true') {
                        if (four_corners.length == 4) {
                            $('.row_0_col_0').addClass('yellow-background');
                            $('.row_0_col_3').addClass('yellow-background');
                            $('.row_3_col_0').addClass('yellow-background');
                            $('.row_3_col_3').addClass('yellow-background');
                            $('#four_corners').show();
                            score += 3;
                            $('#score').html(score);
                            four_corners_done = 'true';

                        }
                    }

                    if (cross_done != 'true') {
                        if (cross.length == 8) {
                            $('.row_0_col_0').addClass('yellow-background');
                            $('.row_1_col_1').addClass('yellow-background');
                            $('.row_2_col_2').addClass('yellow-background');
                            $('.row_3_col_3').addClass('yellow-background');
                            $('.row_0_col_3').addClass('yellow-background');
                            $('.row_1_col_2').addClass('yellow-background');
                            $('.row_2_col_1').addClass('yellow-background');
                            $('.row_3_col_0').addClass('yellow-background');
                            $('#cross').show();
                            score += 5;
                            $('#score').html(score);
                            cross_done = 'true';
                        }
                    }

                    if (bingo_done != 'true') {
                        console.log("numbers_clicked=" + numbers_clicked.length)
                        if (numbers_clicked.length == 16) {
                            $('.col').addClass('yellow-background');
                            $('#bingo').show();
                            score += 6;
                            $('#score').html(score);
                            bingo_done = 'true';
                        }
                    }
                                        
                    //console.log("row_0=" + row_0);
                    //console.log("row_1=" + row_1);
                    //console.log("row_2=" + row_2);
                    //console.log("row_3=" + row_3);
                    //console.log("col_0=" + col_0);
                    //console.log("col_1=" + col_1);
                    //console.log("col_2=" + col_2);
                    //console.log("col_3=" + col_3);
                    //console.log("right_diagonal=" + right_diagonal);
                    //console.log("left_diagonal=" + left_diagonal);
                    //console.log("four_corners=" + four_corners);
                    //console.log("cross=" + cross);
                    
                }
            })
        });
    </script>
</body>

</html>